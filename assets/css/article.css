/* ─────────────────────────────────────────────────────────
   Article / Markdown pages (with safe MathJax CHTML tweaks)
   Drop-in replacement
   ───────────────────────────────────────────────────────── */

/* Container, layout & typography */
article.markdown-body{
  border:3px double var(--section-border);
  background:var(--passage-bg);
  padding:1rem;

  margin:0 auto;
  width:100%;
  text-align:left;
  font-family:"Palatino Linotype","Book Antiqua",Palatino,serif;
  font-size:1.0625rem;
  line-height:1.55;
}

/* Heading & list rhythm (Pandoc-like) */
article.markdown-body p             { margin:0 0 1.1em; }
article.markdown-body h1            { font-size:2em;   margin:1.2em 0 .6em; }
article.markdown-body h2            { font-size:1.6em; margin:1.1em 0 .5em; }
article.markdown-body h3            { font-size:1.3em; margin:1em   0 .5em; }
article.markdown-body h4,
article.markdown-body h5,
article.markdown-body h6            { margin:.8em 0 .4em; }
article.markdown-body ul,
article.markdown-body ol            { margin:0 0 1em 1.5em; }

/* Code & images */
article.markdown-body code{
  font-family:"SFMono-Regular",Consolas,"Liberation Mono",monospace;
  font-size:.95em;
  background:rgba(127,127,127,.08);
  padding:.05em .3em;
  border-radius:3px;
}
article.markdown-body pre code{
  display:block;
  padding:.9em 1em;
  overflow-x:auto;
}
article.markdown-body img{
  max-width:50%;
  height:auto;
  display:block;
  margin:.5rem auto;
}

/* ───── Tables (responsive) ───── */
article.markdown-body table{
  display:block; /*inline-block or block */
  width:max-content;
  /* max-width:100%; */
  max-width:calc(100% - 3.85em); /* Account for the left margin */
  margin:0 0 1em 3.85em;
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
  border-collapse:collapse;
}

article.markdown-body th,
article.markdown-body td{
  padding:.45em .65em;
  text-align:left;
  border:1px solid var(--section-border);
  white-space:nowrap;
  vertical-align:baseline;       /* avoid floaty inline math */
}

/* ───── MathJax (CHTML) — minimal, safe overrides ───── */
/* Keep container text metrics neutral and scoped */
article.markdown-body mjx-container[jax="CHTML"]{
  letter-spacing:normal;
  word-spacing:normal;
  text-indent:0;
}

/* Inline math: inherit surrounding rhythm & stay on baseline */
article.markdown-body mjx-container[jax="CHTML"]:not([display="true"]){
  line-height:inherit;
  vertical-align:baseline;
  text-align:left;
}

/* Display math: correct spacing and horizontal scroll if wide
   NOTE: No font-size override here, so equations won't shrink. */
article.markdown-body .MathJax_Display,
article.markdown-body mjx-container[jax="CHTML"][display="true"]{
  display:block;
  margin:1em 0;
  max-width:100%;
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
  padding-bottom:.25rem;
}

/* Math inside table cells: inherit baseline; avoid forced sizing */
article.markdown-body th mjx-container,
article.markdown-body td mjx-container{
  white-space:normal;
  vertical-align:baseline;
  line-height:inherit;
}

/* ───── Mobile typography tweaks ───── */
@media screen and (max-device-width:480px){
  article.markdown-body{
    font-size:1.15rem;
    line-height:1.6;
  }
  article.markdown-body h1{ font-size:2.1em; }
  article.markdown-body h2{ font-size:1.7em; }
  article.markdown-body a{ padding:.1em 0; display:inline-block; }
  article.markdown-body p{ margin-bottom:1.3em; }

  /* a bit more air for display math on small screens */
  article.markdown-body .MathJax_Display,
  article.markdown-body mjx-container[jax="CHTML"][display="true"]{
    margin:1.5em 0;
  }
}

/* ───── Article floating Back button ───── */
.back-btn{
  right:1rem;
  bottom:5.2rem;  /* stacked above other buttons */
}